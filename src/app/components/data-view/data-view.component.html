<div class="row">
  <div class="col-lg-8 col-md-12">
    <div class="row">
      <div class="col-md-4">
        <div class="card">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="">
                <p class="mb-2 text-secondary">Valeur Magasin</p>
                <div
                  class="d-flex flex-wrap justify-content-start align-items-center"
                >
                  <h5 class="mb-0 font-weight-bold text-success">
                    {{ getMagValue() | numberWithSpaces }} F <br />
                  </h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="">
                <p class="mb-2 text-secondary">Total DÃ©pense</p>
                <div
                  class="d-flex flex-wrap justify-content-start align-items-center"
                >
                  <h5 class="mb-0 font-weight-bold text-danger">
                    {{ getGlobalExpense() | numberWithSpaces }} F
                  </h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="">
                <p class="mb-2 text-secondary">Total Article</p>
                <div
                  class="d-flex flex-wrap justify-content-start align-items-center"
                >
                  <h5 class="mb-0 font-weight-bold">{{ getTotalItem() }}</h5>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12">
        <div class="card">
          <div class="card-header d-flex justify-content-between">
            <div class="header-title">
              <h4 class="card-title">Stock</h4>
            </div>
            <div class="card-header-toolbar d-flex align-items-center">
              <div class="dropdown">
                <a
                  href="#"
                  class="text-muted pl-3"
                  id="dropdownMenuButton-customer"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    stroke="currentColor"
                    stroke-width="2"
                    aria-hidden="true"
                    focusable="false"
                    style="
                      -ms-transform: rotate(360deg);
                      -webkit-transform: rotate(360deg);
                      transform: rotate(360deg);
                    "
                    preserveAspectRatio="xMidYMid meet"
                    viewBox="0 0 24 24"
                  >
                    <g
                      fill="none"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    >
                      <circle cx="12" cy="12" r="1"></circle>
                      <circle cx="19" cy="12" r="1"></circle>
                      <circle cx="5" cy="12" r="1"></circle>
                    </g>
                  </svg>
                </a>
                <div
                  class="dropdown-menu"
                  aria-labelledby="dropdownMenuButton-customer"
                >
                  <a class="dropdown-item" (click)="goToAppro()">
                    <svg
                      class="svg-icon text-secondary"
                      width="20"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                      ></path>
                    </svg>
                    Approvisionner
                  </a>
                  <a class="dropdown-item" (click)="gotToBook()">
                    <svg
                      class="svg-icon text-secondary"
                      width="20"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"
                      />
                    </svg>
                    Carnet
                  </a>
                </div>
              </div>
            </div>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table mb-0">
                <thead class="table-color-heading">
                  <tr class="text-secondary">
                    <th scope="col">Denrees</th>
                    <th scope="col">Existant (J1)</th>
                    <th scope="col">Conso</th>
                    <th scope="col">Appro</th>
                    <th scope="col" class="text-right">Balance</th>
                  </tr>
                </thead>
                <tbody>
                  <tr
                    class="white-space-no-wrap"
                    *ngFor="let data of stock | limitToFive"
                  >
                    <td>{{ data.produit }}</td>
                    <td>
                      {{ data.quantite }}
                    </td>
                    <td class="text-danger">({{ data.conso }})</td>
                    <td class="text-success">{{ data.appro }}</td>
                    <td class="text-right text-primary">{{ data.balance }}</td>
                  </tr>
                </tbody>
              </table>
              <div
                class="d-flex justify-content-end align-items-center border-top-table p-3"
              >
                <button class="btn btn-secondary btn-sm" (click)="sendData()">
                  Voir Tout
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-4 col-md-8">
    <div class="card card-block card-stretch card-height">
      <div
        class="card-header card-header-border d-flex justify-content-between"
      >
        <div class="header-title">
          <h4 class="card-title">Liste Appros</h4>
        </div>
      </div>
      <div class="card-body-list overflow-auto test">
        <ul class="list-style-3 mb-0">
          <li
            *ngFor="let value of supplies"
            class="p-3 list-item d-flex justify-content-start align-items-center"
          >
            <div class="list-style-detail ml-3 mr-2">
              <p class="mb-0">{{ britishDate(value.date) }}</p>
            </div>
            <div class="list-style-action d-flex justify-content-end ml-auto">
              <h6 class="font-weight-bold">
                {{ getDecompte(value) | numberWithSpaces }} F
              </h6>
            </div>
            <button
              class="btn btn-outline-link"
              (click)="printSupplySheet(value)"
            >
              <i class="">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke-width="1.5"
                  stroke="currentColor"
                  width="22"
                  style="color: rgb(5, 209, 66)"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"
                  />
                </svg>
              </i>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="col-lg-8 col-md-8">
    <app-surprimes [magasinDate]="monthData.date"></app-surprimes>
  </div>
  <div class="col-lg-4 col-md-6">
    <app-divers [magasinId]="magasinId"></app-divers>
  </div>
  <div class="col-lg-12 col-md-12">
    <div class="card">
      <div class="card-header d-flex justify-content-between">
        <div class="header-title">
          <h4 class="card-title">SITUATION ADMINISTRATIVE</h4>
        </div>
        <div>
          <button class="btn btn-info" *ngIf="!isEdit" (click)="editTable()">
            Modifier
          </button>
          <div *ngIf="isEdit">
            <button class="btn btn-info ml-2" (click)="SaveTableData()">
              Sauvegarder
            </button>
            <button class="btn btn-outline-link ml-2">Annuler</button>
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-bordered">
            <tr>
              <th class="text-center">DATES</th>
              <th colspan="3" class="text-center" *ngFor="let unite of units">
                {{ unite.nom }}
              </th>
              <th colspan="5" class="text-center">TOTAL</th>
            </tr>
            <tr class="table-active">
              <td>JOUR</td>
              <ng-container *ngFor="let unite of units">
                <td class="text-center">M</td>
                <td class="text-center">M</td>
                <td class="text-center">S</td>
              </ng-container>
              <td class="text-center">M</td>
              <td class="text-center">M</td>
              <td class="text-center">S</td>
              <td class="text-center">TOTAUX</td>
            </tr>
            <tr *ngFor="let _ of [].constructor(totalDay); let i = index">
              <td class="text-center">{{ i + 1 }}</td>
              <ng-container *ngFor="let unite of units; let j = index">
                <td>
                  <input
                    type="number"
                    class="form-control custom"
                    [(ngModel)]="unite.matin[i]"
                    (ngModelChange)="updateTotals(i, j)"
                    [disabled]="!isEdit"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    class="form-control custom"
                    [(ngModel)]="unite.midi[i]"
                    (ngModelChange)="updateTotals(i, j)"
                    [disabled]="!isEdit"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    class="form-control custom"
                    [(ngModel)]="unite.soir[i]"
                    (ngModelChange)="updateTotals(i, j)"
                    [disabled]="!isEdit"
                  />
                </td>
              </ng-container>
              <td class="text-center">
                {{ totalMatin[i] != 0 ? totalMatin[i] : "-" }}
              </td>
              <td class="text-center">
                {{ totalMidi[i] != 0 ? totalMidi[i] : "-" }}
              </td>
              <td class="text-center">
                {{ totalSoir[i] != 0 ? totalSoir[i] : "-" }}
              </td>
              <td class="text-center">
                {{ totalRow[i] | numberWithSpaces }}
              </td>
            </tr>
            <tr>
              <td>TOTAL</td>
              <ng-container *ngFor="let unite of units; let i = index">
                <td class="text-center">
                  {{ unite.totalMatin != 0 ? unite.totalMatin : "-" }}
                </td>
                <td class="text-center">
                  {{ unite.totalMidi != 0 ? unite.totalMidi : "-" }}
                </td>
                <td class="text-center">
                  {{ unite.totalSoir != 0 ? unite.totalSoir : "-" }}
                </td>
              </ng-container>
              <td class="text-center">
                {{ totalMatinSum != 0 ? totalMatinSum : "-" }}
              </td>
              <td class="text-center">
                {{ totalMidiSum != 0 ? totalMidiSum : "-" }}
              </td>
              <td class="text-center">
                {{ totalSoirSum != 0 ? totalSoirSum : "-" }}
              </td>
              <td class="font-weight-bold text-center">
                <div style="width: 120px">
                  {{ globalCost | numberWithSpaces }}
                </div>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
